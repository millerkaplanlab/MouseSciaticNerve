library(scClustViz)
for (Z in list.files("../MouseSciaticNerve_eb1S/")) {
print(Z)
}
for (Z in list.files("../MouseSciaticNerve_eb1S/")) {
list.files(Z)
}
message(list.files(Z))
for (Z in list.files("../MouseSciaticNerve_eb1S/")) {
message(list.files(Z))
}
for (Z in list.files("../MouseSciaticNerve_eb1S/")) {
print(list.files(Z))
}
for (Z in list.files("../MouseSciaticNerve_eb1S/",full.names=T)) {
print(list.files(Z))
}
list.files(Z)
load("~/MK_MSN/MouseSciaticNerve/inst/UninjMesenchymal/UninjMesenchymal.RData")
dim(data_for_scClustViz$nge)
load("../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData")
dim(getExpr(eb1S))
list.files("../MouseSciaticNerve_eb1S/",full.names=T)
load("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData")
load("inst/Inj9dBeads/Inj9dBeads.RData")
dim(getExpr(eb1S))
dim(data_for_scClustViz$nge)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"))
temp_dim <- sapply(filemap$old,function(X) load(X); dim(data_for_scClustViz$nge),simplify=F)
temp_dim <- sapply(filemap$old,function(X) { load(X); dim(data_for_scClustViz$nge) },simplify=F)
temp_dim <- sapply(filemap$old,function(X) { print(X); dim(data_for_scClustViz$nge) },simplify=F)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
stringsAsFactors=F)
temp_dim <- sapply(filemap$old,function(X) { load(X); dim(data_for_scClustViz$nge) },simplify=F)
temp_dim
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData")
stringsAsFactors=F)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
stringsAsFactors=F)
temp_dim_old <- sapply(filemap$old,function(X) { load(X); dim(data_for_scClustViz$nge) },simplify=T)
rm(temp_dim)
temp_dim_old
t(temp_dim_old)
library(scClustViz)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
stringsAsFactors=F)
temp_dim_old <- t(sapply(filemap$old,function(X) { load(X); dim(data_for_scClustViz$nge) },simplify=T))
temp_dim_new <- t(sapply(filemap$old,function(X) { load(X); dim(getExpr(eb1S)) },simplify=T))
load("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData")
temp_dim_new <- t(sapply(filemap$new,function(X) { load(X); dim(getExpr(eb1S)) },simplify=T))
temp_dim_old
temp_dim_new
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
stringsAsFactors=F)
i <- 1
load(filemap$new[1])
load(filemap$old[1])
data_for_scClustViz$cl
head(data_for_scClustViz$cl)
getMD(eb1S)
head(getMD(eb1S))
head(data_for_scClustViz$cl)
load("inst/Inj9dBeads/Inj9dBeads_savedRes.RData")
filemap$old[[1]]
filemap$old[1]
temp_cl <- names(data_for_scClustViz$cl)
head(data_for_scClustViz$md)
levels(data_for_scClustViz$md$orig.ident)
head(getMD(eb1S))
pDat
head(pDat)
temp_cl <- getMD(eb1S)[,names(data_for_scClustViz$cl)]
rownames(pDat) == rownames(getMD(eb1S))
all(rownames(pDat) == rownames(getMD(eb1S)))
head(eb1S@meta.data)
head(eb1S@data.info)
DE_for_scClustViz$params
filemap$old
filemap$old[1]
strsplit(filemap$old[1],"/",fixed=T)
strsplit(filemap$old,"/",fixed=T)[]
strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
temp_name <- strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
assign(paste(temp_name,"seur",sep="_"),eb1S)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
stringsAsFactors=F)
temp_dim_old <- t(sapply(filemap$old,function(X) { load(X); dim(data_for_scClustViz$nge) },simplify=T))
temp_dim_new <- t(sapply(filemap$new,function(X) { load(X); dim(getExpr(eb1S)) },simplify=T))
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
stringsAsFactors=F)
load(filemap$old[6])
dim(data_for_scClustViz$nge)
colnames(data_for_scClustViz$nge)
load(filemap$new[6])
colnames(data_for_scClustViz$nge) %in% colnames(getExpr(eb1S))
load(filemap$new[5])
colnames(data_for_scClustViz$nge) %in% colnames(getExpr(eb1S))
colnames(getExpr(eb1S))
strsplit(colnames(getExpr(eb1S)),"_")
do.call(rbind,strsplit(colnames(getExpr(eb1S)),"_"))
sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[1])
unique(sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[1]))
unique(sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[2]))
unique(sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[1]))
unique(sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[length(X)]))
sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[length(X)])
colnames(data_for_scClustViz$nge) %in% sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[length(X)])
load(filemap$new[6])
colnames(data_for_scClustViz$nge) %in% sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[length(X)])
sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[1])
unique(sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[1]))
unique(sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[2]))
unique(sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[3]))
unique(sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[4]))
unique(sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[5]))
colnames(getExpr(eb1S))
colnames(data_for_scClustViz$nge) %in% sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[length(X)])
all(colnames(data_for_scClustViz$nge) %in% sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[length(X)]))
sapply(filemap$new,function(X) { load(X)
all(colnames(data_for_scClustViz$nge) %in% sapply(strsplit(colnames(getExpr(eb1S)),"_"),function(X) X[length(X)]))
})
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
stringsAsFactors=F)
temp_name <- strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
i <- 6
temp_name <- strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
load(filemap$new[i])
load(filemap$old[i])
colnames(data_for_scClustViz$nge)
sapply(colnames(data_for_scClustViz$nge),function(X) grep(X,colnames(getExpr(eb1S)),value=T))
temp_cells <- sapply(colnames(data_for_scClustViz$nge),function(X) grep(X,colnames(getExpr(eb1S)),value=T))
temp_cl <- getMD(eb1S)[temp_cells,names(data_for_scClustViz$cl)]
dim(data_for_scClustViz$nge)
eb1S[,temp_cells]
pDat
head(pDat)
head(getMD(eb1S))
head(temp_cl)
eb1S@raw.data
eb1S@raw.data <- NULL
eb1S@scale.data <- NULL
eb1S@dr
i <- 6
temp_name <- strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
load(filemap$new[i])
load(filemap$old[i])
temp_cells <- sapply(colnames(data_for_scClustViz$nge),function(X) grep(X,colnames(getExpr(eb1S)),value=T))
temp_cl <- getMD(eb1S)[temp_cells,names(data_for_scClustViz$cl)]
library(Seurat)
temp_seur <- UpdateSeuratObject(eb1S)
devtools::install_version("Seurat",version="v2.3.4")
devtools::install_version("seurat",version="v2.3.4")
devtools::install_version("Seurat",version="2.3.4")
library(Seurat)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
stringsAsFactors=F)
i <- 1
load(filemap$new[i])
temp_seur <- UpdateSeuratObject(eb1S)
temp_seur
temp_seur@meta.data
temp_seur@dr$ica
temp_seur@dr$pca
temp_seur@dr$tsne
eb1S <- UpdateSeuratObject(eb1S)
rm(temp_seur)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
v2=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S_v2.RData"),
stringsAsFactors=F)
filemap$new[1]
filemap$v2[1]
for (i in 1:6) {
load(filemap$new[i])
eb1S <- UpdateSeuratObject(eb1S)
save(eb1S,file=filemap$v2[i])
}
library(scClustViz)
library(Seurat)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
v2=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S_v2.RData"),
stringsAsFactors=F)
for (i in 1:6) {
load(filemap$new[i])
eb1S <- UpdateSeuratObject(eb1S)
save(eb1S,file=filemap$v2[i])
}
devtools::update_packages()
library(scClustViz)
library(Seurat)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal.RData",
"inst/Inj9dFACS/Inj9dFACS.RData",
"inst/InjCombined/InjCombined.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined.RData",
"inst/UninjMesenchymal/UninjMesenchymal.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
v2=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S_v2.RData"),
stringsAsFactors=F)
i <- 6
temp_name <- strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
load(filemap$new[i])
load(filemap$old[i])
temp_cells <- sapply(colnames(data_for_scClustViz$nge),function(X) grep(X,colnames(getExpr(eb1S)),value=T))
temp_cl <- getMD(eb1S)[temp_cells,names(data_for_scClustViz$cl)]
temp_seur <- UpdateSeuratObject(eb1S)
load(filemap$v2[i])
temp_cells <- sapply(colnames(data_for_scClustViz$nge),function(X) grep(X,colnames(getExpr(eb1S)),value=T))
temp_cl <- getMD(eb1S)[temp_cells,names(data_for_scClustViz$cl)]
temp_seur <- UpdateSeuratObject(eb1S)
temp_seur <- DietSeurat(UpdateSeuratObject(eb1S),counts=F)
colnames(temp_seur)
temp_cell
temp_cells
SubsetData(temp_seur,cells=temp_cells)
subset(temp_seur,cells=temp_cells)
temp_seur <- subset(temp_seur,cells=temp_cells)
temp_seur@meta.data
pDat
if (all(rownames(pDat) == rownames(getMD(eb1S)))) {
temp_seur@meta.data <- pDat
} else {
stop("rownames don't line up")
}
temp_cl
rownames(temp_cl) == colnames(temp_seur)
rownames(temp_cl)
rownames(getMD(temp_seur))
dim(pDat)
i <- 6
temp_name <- strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
load(filemap$new[i])
load(filemap$v2[i])
load(filemap$old[i])
temp_cells <- sapply(colnames(data_for_scClustViz$nge),function(X) grep(X,colnames(getExpr(eb1S)),value=T))
temp_cl <- getMD(eb1S)[temp_cells,names(data_for_scClustViz$cl)]
temp_seur <- DietSeurat(UpdateSeuratObject(eb1S),counts=F)
temp_seur <- subset(temp_seur,cells=temp_cells)
if (all(rownames(pDat) == rownames(getMD(temp_seur)))) {
temp_seur@meta.data <- pDat
} else {
stop("rownames don't line up")
}
head(pDat)
temp_seur@meta.data <- pDat[temp_cells,]
assign(paste(temp_name,"seur",sep="_"),temp_seur)
temp_name
library(scClustViz)
library(Seurat)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads_old.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal_old.RData",
"inst/Inj9dFACS/Inj9dFACS_old.RData",
"inst/InjCombined/InjCombined_old.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined_old.RData",
"inst/UninjMesenchymal/UninjMesenchymal_old.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
v2=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S_v2.RData"),
stringsAsFactors=F)
i <- 6
temp_name <- strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
load(filemap$new[i])
load(filemap$v2[i])
load(filemap$old[i])
temp_cells <- sapply(colnames(data_for_scClustViz$nge),function(X) grep(X,colnames(getExpr(eb1S)),value=T))
temp_cl <- getMD(eb1S)[temp_cells,names(data_for_scClustViz$cl)]
temp_seur <- DietSeurat(UpdateSeuratObject(eb1S),counts=F)
temp_seur <- subset(temp_seur,cells=temp_cells)
temp_seur@meta.data <- pDat[temp_cells,]
temp_scv <- CalcAllSCV(inD=temp_seur,clusterDF=temp_cl)
temp_scv <- CalcAllSCV(inD=temp_seur,clusterDF=temp_cl,assayType="RNA")
data_for_scClustViz$cl
dim(data_for_scClustViz$cl)
data_for_scClustViz$cl[names(temp_cells),]
temp_cl <- data_for_scClustViz$cl[names(temp_cells),]
rownames(temp_cl) <- temp_cells
temp_scv <- CalcAllSCV(inD=temp_seur,clusterDF=temp_cl,assayType="RNA")
assign(paste(temp_name,"seur",sep="_"),temp_seur)
assign(paste(temp_name,"sCVdL",sep="_"),temp_scv)
save(paste(temp_name,"seur",sep="_"),paste(temp_name,"sCVdL",sep="_"),
file=paste0("inst/",temp_name,"/",temp_name,".RData"))
paste(temp_name,"seur",sep="_")
save(list=c(paste(temp_name,"seur",sep="_"),paste(temp_name,"sCVdL",sep="_")),
file=paste0("inst/",temp_name,"/",temp_name,".RData"))
for (i in 1:5) {
temp_name <- strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
load(filemap$new[i])
load(filemap$v2[i])
load(filemap$old[i])
temp_seur <- DietSeurat(UpdateSeuratObject(eb1S),counts=F)
temp_cl <- getMD(temp_seur)[,names(data_for_scClustViz$cl)]
if (all(rownames(pDat) == rownames(getMD(temp_seur)))) {
temp_seur@meta.data <- pDat
} else {
stop("rownames don't line up")
}
temp_scv <- CalcAllSCV(inD=temp_seur,clusterDF=temp_cl,assayType="RNA")
assign(paste(temp_name,"seur",sep="_"),temp_seur)
assign(paste(temp_name,"sCVdL",sep="_"),temp_scv)
save(list=c(paste(temp_name,"seur",sep="_"),paste(temp_name,"sCVdL",sep="_")),
file=paste0("inst/",temp_name,"/",temp_name,".RData"))
}
load("~/MK_MSN/MouseSciaticNerve/inst/Inj9dBeads/Inj9dBeads.RData")
getEmb(Inj9dBeads_seur)
getEmb(Inj9dBeads_seur,"ica")
i <- 1
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads_old.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal_old.RData",
"inst/Inj9dFACS/Inj9dFACS_old.RData",
"inst/InjCombined/InjCombined_old.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined_old.RData",
"inst/UninjMesenchymal/UninjMesenchymal_old.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
v2=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S_v2.RData"),
stringsAsFactors=F)
filemap <- data.frame(old=c("inst/Inj9dBeads/Inj9dBeads_old.RData",
"inst/Inj9dBeadsMesenchymal/Inj9dBeadsMesenchymal_old.RData",
"inst/Inj9dFACS/Inj9dFACS_old.RData",
"inst/InjCombined/InjCombined_old.RData",
"inst/InjUninjMesenchymalCombined/InjUninjMesenchymalCombined_old.RData",
"inst/UninjMesenchymal/UninjMesenchymal_old.RData"),
new=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S.RData"),
v2=c("../MouseSciaticNerve_eb1S/9dInjuredBeads/9dInjuredBeads_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredBeadsMesenchymal/9dInjuredBeadsMesenchymal_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/9dInjuredFACS/9dInjuredFACS_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/CombinedInjured/CombinedInjured_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombined/InjUninjMesCombined_eb1S_v2.RData",
"../MouseSciaticNerve_eb1S/InjUninjMesCombinedBatchCorrected/InjUninjMesCombinedBatchCorrected_eb1S_v2.RData"),
stringsAsFactors=F)
i <- 1
temp_name <- strsplit(filemap$old[i],"/",fixed=T)[[1]][2]
load(filemap$new[i])
load(filemap$v2[i])
load(filemap$old[i])
temp_seur <- DietSeurat(UpdateSeuratObject(eb1S),counts=F)
temp_cl <- getMD(temp_seur)[,names(data_for_scClustViz$cl)]
if (all(rownames(pDat) == rownames(getMD(temp_seur)))) {
temp_seur@meta.data <- pDat
} else {
stop("rownames don't line up")
}
temp_scv <- CalcAllSCV(inD=temp_seur,clusterDF=temp_cl,assayType="RNA",storeAllDE=F)
i
assign(paste(temp_name,"seur",sep="_"),temp_seur)
assign(paste(temp_name,"sCVdL",sep="_"),temp_scv)
save(list=c(paste(temp_name,"seur",sep="_"),paste(temp_name,"sCVdL",sep="_")),
file=paste0("inst/",temp_name,"/",temp_name,".RData"))
head(DEvsRest(temp_scv$res.3))
head(DEvsRest(temp_scv$res.3)[[1]])
